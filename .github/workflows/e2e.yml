name: cross browser end-to-end testing 🚀

on:
  workflow_dispatch:
  push:
    branches:
      - 'main'
  pull_request:
   types:
      - opened
  schedule:
    - cron: '0 2 * * *'

jobs:
 cypress-run:
   runs-on: ubuntu-latest

   steps:
    - name: Checkout code 🛎
      uses: actions/checkout@v3

    - name: Run docker-compose 🐳
      run: docker-compose up

    - name: Archive and upload Chrome artifacts
      uses: actions/upload-artifact@v3
      with:
        name: chrome-artifacts
        path: |
          ./artifacts/chrome/videos
          ./artifacts/chrome/screenshots

    - name: Archive and upload Firefox artifacts
      uses: actions/upload-artifact@v3
      with:
        name: firefox-artifacts
        path: |
          ./artifacts/firefox/videos
          ./artifacts/firefox/screenshots

    - name: Archive and upload Edge artifacts
      uses: actions/upload-artifact@v3
      with:
        name: edge-artifacts
        path: |
          ./artifacts/edge/videos
          ./artifacts/edge/screenshots
