name: cross browser end-to-end testing 🚀

on:
  workflow_dispatch:
  push:
    branches:
      - 'main'
  pull_request:
   types:
      - opened
  schedule:
    - cron: '*/2 * * * *'

jobs:
 cypress-run:
   runs-on: ubuntu-latest
   steps:
    - name: Checkout code 🛎
      uses: actions/checkout@v3

    - name: Run docker-compose 🐳
      run: docker-compose up

    - name: Save artifacts - screenshots 📷
      uses: actions/upload-artifact@v3
      if: failure()
      with:
        name: cypress-screenshots
        path: /cypress/screenshots

    - name: Save artifacts - videos 📹
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: cypress-videos
        path: /cypress/videos